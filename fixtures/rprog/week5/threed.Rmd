## 3D and image plots

```{r, echo=FALSE}
palette(c('#000000', '#951272',  '#00843D', '#003865', '#BE4D00', '#0075B0', '#B30C00', '#FFDC36', '#00B5D1', '#7D2239',  '#AA8066', '#5B4D94', '#FFB948'))
library(magrittr)
library(dplyr)
load(url("http://www.stats.gla.ac.uk/~levers/rp/w5.RData"))
```
The functions `persp(x, y, M, ...)`, `image(x, y, M, ...)`,
`contour(x, y, M, ...)`, and `filled.contour(x, y, M, ...)` can be used to
visualise functions $f(x,y)$ of two variables $x$ and $y$. The functions are also useful when visualising spatial or map data.

The two (optional) arguments are vectors containing the different
values of `x` and `y` respectively. `M` is a matrix containing the values of
$f$, such that
$$
M_{ij}=f(x_i,y_j)
$$
In other words, these functions need the data in "wide" format.

####[example]Bivariate Gaussian density
In this example we will plot the probability density function of the two-dimensional standard normal distribution

$$f(x,y)=\phi(x)\cdot \phi(y),$$

which is the product of the probability density function of the univariate standard normal distribution (as $X$ and $Y$ are independent).

We need to evaluate the function $f(x,y)$ for all combinations of input values $x_i$ and $y_j$. It is easiest if we start with putting together a data frame which contains all these combinations: this can be done using the function `expand.grid`:
```{r}
x <- seq(-2, 2, len=50)
y <- seq(-2, 2, len=50)
data <- expand.grid(x=x, y=y) %>%
    mutate(z=dnorm(x)*dnorm(y))

```
We next have to use `spread` to arrange the data in wide matrix form.
```{r}
library(tidyr)
z <- data %>%
       spread(y, z) %>%
       select(-x) %>%
       as.matrix()
```

We can then create the 3D and image plots using
```{r, fig.width=10, fig.height=6, out.width="\\textwidth"}
layout(rbind(c(3, 3, 1),
             c(3, 3, 2)))                       # Split the figure
contour(x, y, z)                                # Contour plot
image(x, y, z, col=rainbow(100))                # Image plot
persp(x, y, z, theta=30, phi=30, col="yellow", shade=0.5) # 3D perspective plot
                                                
```

The arguments `theta` and `phi` of the `persp` allow for changing the
angle from which the surface is viewed.

####[/example]

<!--[if PDF]>
\newpage
<![endif]-->
