## More examples

```{r, echo=FALSE}
palette(c('#000000', '#951272',  '#00843D', '#003865', '#BE4D00', '#0075B0', '#B30C00', '#FFDC36', '#00B5D1', '#7D2239',  '#AA8066', '#5B4D94', '#FFB948'))
library(magrittr)
library(dplyr)
load(url("http://www.stats.gla.ac.uk/~levers/rp/w5.RData"))
```

###[example]Fisher's iris data
In this example we look at Fisher's famous iris data, a data set available in R.
The data gives, for 50 flowers, four measurements (sepal length and width and petal length and width). The flowers in the data set come from three species: Iris setosa, versicolor, and virginica.
```{r}
head(iris)
```
We will start with putting together a plot of the sepal length and sepal width. We will use the plotting symbol and colour to denote the species.
```r
plot(Sepal.Width~Sepal.Length, data=iris,
     col=unclass(Species),   
     pch=unclass(Species),
     main="Fisher's iris data")
```
Next, we will add a legend.
```r
legend("topleft", pch=1:3, col=1:3, 
       legend=c("setosa", "versicolor", "virginica"))
```
Finally, we will use a large plotting symbol to denote the mean values for each species
```r
species.means <- iris %>%
                     group_by(Species) %>%
                     summarise_all(mean)
species.means %$%
    points(Sepal.Length, Sepal.Width, pch=1:3, col=1:3, cex=3)                  
```
```{r, dev.args=list(pointsize=10), echo=FALSE}
plot(Sepal.Width~Sepal.Length, data=iris,
     col=unclass(Species),   
     pch=unclass(Species),
     main="Fisher's iris data")
legend("topleft", pch=1:3, col=1:3, 
       legend=c("setosa", "versicolor", "virginica"))
species.means <- iris %>%
                     group_by(Species) %>%
                     summarise_all(mean)
species.means %$%
    points(Sepal.Length, Sepal.Width, pch=1:3, col=1:3, cex=3)     
```

###[/example]


###[example]House prices in the UK
Once you have loaded 
```{r}
load(url("http://www.stats.gla.ac.uk/~levers/rp/w5.RData"))
```
you can access a data frame `hp`, which contains the median house price for all regions of the UK for the periods from 1996 to 2016.
````{r}
head(hp)
```
The data is in wide format. If we want to plot a line for each region. we first need to set up a plotting region that is large enough. We use the common trick to plot `NULL`, which does not draw anything (we'll draw the lines later on).
```r
plot(NULL, xlim=range(hp$Year), ylim=range(hp[,-1]),
     xlab="Year", ylab="Median house price")
```
We now have an empty canvas, so we next add the lines corresponding to each region one by one. We will use a loop (we'll cover loops in more detail in a fortnight). 
```r
for (i in 2:ncol(hp))
    lines(hp$Year, hp[,i], col=i)
```
Finally  we add a legend.
```r
legend("topleft", lty=1, col=2:ncol(hp), colnames(hp)[-1])
```
```{r,echo=FALSE, dev.args=list(pointsize=10)}
matplot(hp$Year, hp[,-1], type="l", col=2:ncol(hp), lty=1,
        xlab="Year", ylab="Median house price")
legend("topleft", lty=1, col=2:ncol(hp), colnames(hp)[-1])
```

This seemed rather complicated. Luckily enough, there is an R function `matplot`, which plots matrices column by column.
```r
matplot(hp$Year, hp[,-1], type="l", col=2:ncol(hp), lty=1,
        xlab="Year", ylab="Median house price")
legend("topleft", lty=1, col=2:ncol(hp), colnames(hp)[-1])
```

###[/example]

<!--[if PDF]>
\newpage
<![endif]-->
