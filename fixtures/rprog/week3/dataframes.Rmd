## Data frames

### Data frame basics


####[video, videoid="SSei0Sf_nu0", duration="10m58s"] Data frames

#### Why data frames?

Last week we learned how to create matrices. In principle, we could use matrices to store data sets. However, matrices (and vectors) have one important constraint: all entries of a vector or a matrix have to be of the same data type. Many data sets we work with have both numerical and factor variables, so we would need to store our data using different data types for the different columns. We could in theory use lists to manage such data. However, lists do not enforce the constraint that each variable has the same number of observations, so if we used lists our data would soon get messy.

Let's look at an example illustrating this limitation of matrices.

Consider a matrix \texttt{kids} containing age, weight and height of two children.
```{r}
kids <- rbind(c( 4, 15, 101),
              c(11, 28, 132))
colnames(kids) <- c("age", "weight", "height")
rownames(kids) <- c("Sarah", "John")
kids
```
We can for example see that John is older than Sarah.
```{r}
kids["John", "age"] > kids["Sarah", "age"]
```

Let's now try adding a column gender.
```{r}
kids2 <- cbind(kids, gender=c("f", "m"))
kids2
```
Let's see whether John is still older than Sarah.
```{r}
kids2["John", "age"] > kids2["Sarah", "age"]
```
Not any more. How come? We have added the variable `gender`, which is a character vector. As all the data in the matrix needs to be of the same data type, R had to convert all the columns, including `age` to character strings, and character strings do not compare in the same way as numbers: in a dictionary `11` would be before `4`. We can see from the quotes around the numerical variables that these have been converted to characters (accidental conversion to factors is slightly more difficult to spot, as R prints factors without quotes). 

Because of situations like this one it is better to use data frames (or [tibbles](https://cran.r-project.org/web/packages/tibble/index.html), which we look at next week) to store data sets. 

#### Creating data frames

A matrix can be converted to a data frame using `as.data.frame` and we can convert a data frame back to a matrix using `as.matrix`.

```{r}
kids <- as.data.frame(kids)
kids <- cbind(kids, gender=c("f","m"))
kids
kids["John", "age"] > kids["Sarah", "age"]   
```
A data frame can handle columns of different data types, so the numeric column is not converted when adding a character (or factor) column. 

Data frames can be created using the function `data.frame`, so we could have created the data set using
```{r}
kids <- data.frame(age=c(4,11), weight=c(15,28), height=c(101,132), gender=c("f", "m"))
rownames(kids) <- c("Sarah", "John")
```
or
```{r}
kids <- rbind(Sarah=data.frame(age=4, weight=15, height=101, gender="f"),
              John=data.frame(age=11, weight=28, height=132, gender="m"))
```
A data frame has row names and column names like a matrix and these can be set in the same way as for matrices. Data frames can also be subset like matrices. We will come back to this later on.<!--[later on](ref://datasubsetting).-->

#### Data frames also behave like lists
Data frames behave not just only like matrices, they also behave like lists (with the columns being the entries). We can use `$` to access columns:
```{r}
kids$age
```
So for a data frame, the following four lines of R commands are all equivalent
````{r}
kids$age             
kids[,"age"]         
kids[,1]
kids[["age"]]
kids[[1]]
```
As mentioned previously, it is always better to refer to columns by their name rather than their index. The latter is too likely to change as you work with the data.

We can use the same notation to set values in the data frame. Suppose it was John's birthday and we want to change his age to 5. We can use any of the lines below (and there are even more possible ways).
```{r}
kids["John", "age"] <- 5
kids$age[2] <- 5
kids[2,1] <- 5
kids[[2]][1] <- 5
```
Again, the command at the top is probably best, because it is the most "human-readable". 

\newpage
